# 设备管理微服务

基于 Python Sanic 框架构建的设备管理微服务，提供设备全生命周期管理、实时通信及自动化部署能力，适用于物联网场景下的设备接入与管控需求。


## 📋 项目简介

本项目是一个轻量级设备管理微服务，核心功能包括：
- 设备身份管理（注册、登录认证）
- 设备及设备组的完整CRUD操作
- 基于WebSocket的设备与服务器实时通信
- 基于Redis的设备心跳检测机制
- 全流程自动化部署（代码提交触发流水线部署至Docker）

项目采用微服务架构设计，可独立部署并通过API与其他服务联动，适合物联网平台中设备层的管理需求。


## ✨ 核心功能

### 1. 设备身份管理
- 设备注册：支持批量/单个设备信息录入，生成唯一设备标识
- 设备登录：基于令牌的身份认证，保障设备接入安全性
- 身份注销：支持设备权限吊销与信息归档

### 2. 设备与设备组管理
- 设备管理：查询设备状态、更新设备信息、删除无效设备
- 设备组管理：设备分组创建、修改、删除，支持批量设备组操作
- 关联查询：查询设备所属组、组内设备列表等关联关系

### 3. 实时通信与状态监控
- WebSocket通信：设备与服务器双向实时数据传输
- 心跳机制：基于Redis存储设备心跳时间，实时监测设备在线状态
- 断线检测：定时清理超时未心跳设备，更新离线状态

### 4. 自动化部署
- 代码提交触发：Git提交后自动触发构建流程
- 容器化部署：通过Docker打包应用，确保环境一致性
- 全流程自动化：从代码检查、构建、测试到部署的端到端自动化


## 🛠️ 技术栈

- **后端框架**：Python 3.8+、Sanic（高性能异步Web框架）
- **数据存储**：
  - MySQL：存储设备、设备组等结构化数据
  - Redis：缓存设备状态、心跳信息、临时令牌
- **通信协议**：HTTP/HTTPS、WebSocket
- **部署工具**：
  - Docker：应用容器化
  - 阿里云DevOps工具链：
    - CodeUp：代码仓库
    - 云效Flow：CI/CD流水线
    - ACR：容器镜像仓库


## 🏗️ 项目结构

```
device-management-service/
.
├── North                   #北向接口：负责设备和设备组CRUD操作
├── South                   #南向接口：负责websocket通信
├── clientUploads           #设备上传的状态信息日志  
├── client_Test.py          #设备端启动程序
├── client_util             #设备端主要代码程序
├── requirements.txt        #环境配置
├── server.py               #设备管理服务端启动程序
├── server_logs             #服务端日志
├── util                    #操作mysql和redis工具函数
└── 相关非代码文件
    ├── device_manage.sql
    └── 测试命令.txt


```

## 📌 项目亮点

1. **高性能**：基于Sanic异步框架，支持高并发设备接入
2. **实时性**：WebSocket通信+Redis心跳机制，确保设备状态实时同步
3. **高可用**：容器化部署保障环境一致性，自动化流水线减少部署失误
4. **可扩展**：模块化设计，便于功能扩展与服务拆分
5. **安全性**：设备身份认证+接口权限控制，保障数据安全
